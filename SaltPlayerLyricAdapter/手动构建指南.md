# 🛠️ 手动构建指南

## 方案1: 使用Android Studio (推荐)

### 步骤1: 下载并安装
1. 下载 Android Studio: https://developer.android.com/studio
2. 安装时选择 "Standard" 配置
3. 等待SDK下载完成（约2-5GB）

### 步骤2: 打开项目
1. 打开 Android Studio
2. 选择 "Open an existing project"
3. 选择 `C:\SaltPlayerLyricAdapter` 文件夹
4. 等待Gradle同步完成（首次约5-10分钟）

### 步骤3: 构建APK
1. 点击顶部菜单: `Build` → `Build Bundle(s) / APK(s)` → `Build APK(s)`
2. 等待构建完成（约2-5分钟）
3. 右下角会显示 "Build Analyzer"，点击 `locate` 找到APK
4. APK路径: `app/build/outputs/apk/debug/app-debug.apk`

---

## 方案2: 使用命令行（需要有Gradle）

### 前提条件
需要先安装:
1. Java JDK 17: https://adoptium.net/temurin/releases/?version=17
2. Android SDK: 通过Android Studio安装
3. 配置环境变量

### 构建步骤
```batch
cd C:\SaltPlayerLyricAdapter

REM 方式1: 使用gradlew（Windows）
gradlew.bat :app:assembleDebug

REM 方式2: 如果你有全局安装的gradle
gradle :app:assembleDebug

REM 方式3: 清理并重新构建
gradlew.bat clean :app:assembleDebug
```

---

## 方案3: 最简单的方法 - 在线构建服务

如果你没有开发环境，可以使用GitHub Actions自动构建：

### 步骤1: 上传代码到GitHub
1. 在GitHub创建新仓库: `SaltPlayerLyricAdapter`
2. 上传所有文件到该仓库

### 步骤2: 添加GitHub Actions工作流
创建文件 `.github/workflows/build.yml`:

```yaml
name: Build APK

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
    
    - name: Grant execute permission for gradlew
      run: chmod +x gradlew
    
    - name: Build with Gradle
      run: ./gradlew :app:assembleDebug
    
    - name: Upload APK
      uses: actions/upload-artifact@v4
      with:
        name: debug-apk
        path: app/build/outputs/apk/debug/*.apk
```

### 步骤3: 自动构建
- 提交代码后，GitHub会自动构建
- 进入Actions标签页查看构建状态
- 完成后在Artifacts中下载APK

---

## 🔧 常见问题解决

### 问题1: "gradlew.bat 不是内部或外部命令"
**解决**: 项目缺少Gradle Wrapper，需要创建：

```batch
cd C:\SaltPlayerLyricAdapter

REM 下载gradle wrapper
gradle wrapper --gradle-version 8.7

REM 如果gradle未安装，手动创建wrapper目录：
mkdir gradle\wrapper
```

然后创建文件 `gradle/wrapper/gradle-wrapper.properties`:
```properties
distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
distributionUrl=https\://services.gradle.org/distributions/gradle-8.7-bin.zip
networkTimeout=10000
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
```

### 问题2: "找不到Android SDK"
**解决**: 设置环境变量:
1. 找到Android SDK路径（通常在 `C:\Users\你的用户名\AppData\Local\Android\Sdk`）
2. 添加环境变量:
   ```
   ANDROID_HOME=C:\Users\用户名\AppData\Local\Android\Sdk
   ```
3. 添加到PATH:
   ```
   %ANDROID_HOME%\platform-tools
   %ANDROID_HOME%\tools
   ```

### 问题3: "Java版本不匹配"
**解决**: 确保安装JDK 17:
```batch
REM 检查Java版本
java -version

REM 应该显示 "17" 或 "openjdk version 17"
```

---

## 📱 快速测试方案

如果构建困难，你可以先用这个预配置项目测试：

1. **使用现有APK**: 如果没有构建环境，可以先用其他LyricProvider插件测试Lyricon是否工作正常

2. **最小化测试**: 创建一个最简单的测试模块:
   - 只Hook `android.app.Notification`
   - 从通知中提取文本发送到Lyricon
   - 不需要完整的项目结构

---

## ✅ 验证构建成功

构建完成后，检查:
```
✅ 文件存在: app/build/outputs/apk/debug/app-debug.apk
✅ 文件大小: 约 2-5MB
✅ 可以安装: adb install app-debug.apk 成功
```

---

## 🆘 获取帮助

如果还是无法构建:
1. **完整日志**: 运行 `gradlew.bat :app:assembleDebug --stacktrace > build.log 2>&1`，然后发给我
2. **环境信息**: 告诉我你的Windows版本、是否安装了Android Studio
3. **替代方案**: 我可以帮你设置GitHub Actions自动构建
