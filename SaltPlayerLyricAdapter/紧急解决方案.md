# âš¡ ç´§æ€¥è§£å†³æ–¹æ¡ˆ - æ²¡æœ‰å¼€å‘ç¯å¢ƒæ€ä¹ˆåŠï¼Ÿ

å¦‚æœä½ æ— æ³•æ„å»ºé¡¹ç›®ï¼Œè¿™é‡Œæœ‰å‡ ç§æ›¿ä»£æ–¹æ¡ˆï¼š

---

## ğŸ¯ æ–¹æ¡ˆ1: ä½¿ç”¨ç°æœ‰LyricProvideræ’ä»¶æµ‹è¯•

åœ¨æ„å»ºè‡ªå·±çš„é€‚é…å™¨ä¹‹å‰ï¼Œå…ˆç¡®è®¤Lyriconèƒ½æ­£å¸¸å·¥ä½œï¼š

### æ­¥éª¤ï¼š
1. **ä¸‹è½½ç°æˆæ’ä»¶**
   - è®¿é—®: https://github.com/proify/LyricProvider/releases
   - ä¸‹è½½é€‚åˆä½ éŸ³ä¹Appçš„æ’ä»¶ï¼ˆå¦‚ç½‘æ˜“äº‘éŸ³ä¹ã€QQéŸ³ä¹ã€Apple Musicï¼‰

2. **å®‰è£…æµ‹è¯•**
   - å®‰è£…LyricProvideræ’ä»¶APK
   - LSPosedä¸­å¯ç”¨æ’ä»¶
   - æ’­æ”¾éŸ³ä¹æµ‹è¯•çŠ¶æ€æ æ­Œè¯

3. **ç¡®è®¤Lyriconå·¥ä½œæ­£å¸¸**
   - å¦‚æœèƒ½æ˜¾ç¤ºæ­Œè¯ï¼Œè¯´æ˜ç¯å¢ƒé…ç½®æ­£ç¡®
   - ç„¶åå†å°è¯•æ„å»ºSalt Playeré€‚é…å™¨

---

## ğŸ¯ æ–¹æ¡ˆ2: æœ€å°åŒ–æµ‹è¯•ä»£ç 

å¦‚æœä½ åªæ˜¯æƒ³å¿«é€Ÿæµ‹è¯•Hookæ˜¯å¦æœ‰æ•ˆï¼Œå¯ä»¥ç”¨è¿™ä¸ªç®€åŒ–ç‰ˆï¼š

### åˆ›å»ºæ–‡ä»¶: `SimpleTest.kt`

```kotlin
package com.test

import android.app.AndroidAppHelper
import android.app.Notification
import android.media.MediaMetadata
import android.media.session.MediaController
import android.media.session.MediaSessionManager
import com.highcapable.yukihookapi.hook.entity.YukiBaseHooker
import com.highcapable.yukihookapi.hook.log.YLog
import de.robv.android.xposed.callbacks.XC_LoadPackage

class SimpleTest : YukiBaseHooker() {
    override fun onHook() {
        YLog.info("=== SimpleTest Hook Started ===")
        
        // æ–¹æ³•1: Hooké€šçŸ¥
        findClass("android.app.NotificationManager").apply {
            method {
                name = "notify"
            }.hook {
                before {
                    val notification = args[1] as? Notification
                    notification?.let { notif ->
                        val title = notif.extras?.getString(Notification.EXTRA_TITLE) ?: ""
                        val text = notif.extras?.getCharSequence(Notification.EXTRA_TEXT)?.toString() ?: ""
                        
                        YLog.info("Notification: title=$title, text=$text")
                        
                        // å¦‚æœæ˜¯Salt Playerçš„é€šçŸ¥
                        if (title.contains("Salt") || text.isNotBlank()) {
                            YLog.info(">>> Found Salt Player notification!")
                        }
                    }
                }
            }
        }
        
        // æ–¹æ³•2: ç›‘æ§MediaSession
        val context = AndroidAppHelper.currentApplication()
        val sessionManager = context.getSystemService(Context.MEDIA_SESSION_SERVICE) as MediaSessionManager
        
        val controllers = sessionManager.getActiveSessions(null)
        controllers.forEach { controller ->
            YLog.info("MediaSession: ${controller.packageName}")
            if (controller.packageName == "com.salt.music") {
                val metadata = controller.metadata
                val title = metadata?.getString(MediaMetadata.METADATA_KEY_TITLE)
                YLog.info(">>> Salt Player playing: $title")
            }
        }
    }
}
```

### è¿™ä¸ªç®€åŒ–ç‰ˆå¯ä»¥ï¼š
- æµ‹è¯•Xposedç¯å¢ƒæ˜¯å¦æ­£å¸¸
- ç¡®è®¤èƒ½å¦æ‹¦æˆªé€šçŸ¥
- æŸ¥çœ‹MediaSessionä¿¡æ¯
- ä¸éœ€è¦å®Œæ•´é¡¹ç›®ç»“æ„

---

## ğŸ¯ æ–¹æ¡ˆ3: ä½¿ç”¨GitHub Actionsè‡ªåŠ¨æ„å»º

### æœ€ç®€å•çš„è‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼š

1. **åœ¨GitHubåˆ›å»ºä»“åº“**
   ```
   è®¿é—®: https://github.com/new
   ä»“åº“å: SaltPlayerLyricAdapter
   é€‰æ‹©: Public
   ```

2. **ä¸Šä¼ ä»£ç **
   - ä¸‹è½½é¡¹ç›®ZIP
   - è§£å‹åä¸Šä¼ åˆ°GitHub

3. **æˆ‘å·²ç»ä¸ºä½ å‡†å¤‡äº†GitHub Actionsé…ç½®**

åˆ›å»ºæ–‡ä»¶ `.github/workflows/build.yml`:

```yaml
name: Build APK

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
        cache: gradle
    
    - name: Setup Gradle
      uses: gradle/actions/setup-gradle@v3
      with:
        gradle-version: 8.7
    
    - name: Create Gradle Wrapper
      run: gradle wrapper --gradle-version 8.7
    
    - name: Grant execute permission
      run: chmod +x gradlew
    
    - name: Build Debug APK
      run: ./gradlew :app:assembleDebug --stacktrace
    
    - name: Upload APK
      uses: actions/upload-artifact@v4
      with:
        name: salt-player-lyric-adapter-debug
        path: app/build/outputs/apk/debug/*.apk
        retention-days: 30
```

4. **è§¦å‘æ„å»º**
   - æäº¤ä»£ç åè‡ªåŠ¨æ„å»º
   - æˆ–è¿›å…¥Actionsæ ‡ç­¾é¡µæ‰‹åŠ¨è§¦å‘
   - çº¦5-10åˆ†é’Ÿååœ¨Artifactsä¸‹è½½APK

---

## ğŸ¯ æ–¹æ¡ˆ4: å¯»æ±‚ç¤¾åŒºå¸®åŠ©

### ä½ å¯ä»¥ï¼š

1. **å‘å¸ƒåˆ°XDAè®ºå›**
   - å¾ˆå¤šå¼€å‘è€…æ„¿æ„å¸®å¿™æ„å»º
   - é“¾æ¥: https://forum.xda-developers.com/

2. **GitHub Discussions**
   - åœ¨Lyriconæˆ–Salt Playeré¡¹ç›®å‘èµ·è®¨è®º
   - è¯·æ±‚ç¤¾åŒºååŠ©æ„å»º

3. **å›½å†…ç¤¾åŒº**
   - é…·å®‰ç½‘: https://www.coolapk.com/
   - å‘å¸ƒéœ€æ±‚å¯»æ±‚å¸®åŠ©

---

## ğŸ¯ æ–¹æ¡ˆ5: æ‰‹åŠ¨åˆ›å»ºæœ€ç®€APK

å¦‚æœçœŸçš„æ— æ³•æ„å»ºï¼Œæˆ‘å¯ä»¥å¸®ä½ åˆ›å»ºä¸€ä¸ª**é¢„ç¼–è¯‘çš„åŸºç¡€æ¨¡æ¿**ï¼Œä½ åªéœ€è¦ä¿®æ”¹å‡ ä¸ªå‚æ•°å³å¯ã€‚

### æˆ‘å¯ä»¥æä¾›ï¼š
- é¢„ç¼–è¯‘çš„APKæ¨¡æ¿ï¼ˆç©ºå£³ï¼‰
- é…ç½®æ–‡ä»¶ä¿®æ”¹æŒ‡å—
- é‡æ–°æ‰“åŒ…è„šæœ¬

**éœ€è¦çš„æ¡ä»¶**ï¼š
- å®‰è£…Apktool: https://apktool.org/
- å®‰è£…Java
- åŸºç¡€å‘½ä»¤è¡Œæ“ä½œ

---

## ğŸ” æ¨èçš„æœ€ä½³å®è·µ

### å¯¹äºæ²¡æœ‰å¼€å‘ç¯å¢ƒçš„ç”¨æˆ·ï¼š

1. **é¦–é€‰**: ä½¿ç”¨GitHub Actionsè‡ªåŠ¨æ„å»º (æ–¹æ¡ˆ3)
   - å®Œå…¨è‡ªåŠ¨åŒ–
   - ä¸éœ€è¦æœ¬åœ°ç¯å¢ƒ
   - æ¯æ¬¡æ›´æ–°è‡ªåŠ¨æ„å»º

2. **å¤‡é€‰**: å¯»æ±‚ç¤¾åŒºå¸®åŠ© (æ–¹æ¡ˆ4)
   - æœ‰å¾ˆå¤šçƒ­å¿ƒçš„å¼€å‘è€…
   - å¯ä»¥å¿«é€Ÿè·å¾—å¯è¿è¡Œçš„APK

3. **æœ€å**: æ‰‹åŠ¨åˆ›å»º (æ–¹æ¡ˆ5)
   - éœ€è¦ä¸€å®šçš„æŠ€æœ¯åŸºç¡€
   - ä½†å®Œå…¨å¯æ§

---

## ğŸ†˜ è·å–æˆ‘çš„å¸®åŠ©

å¦‚æœä½ è¿˜æ˜¯æ— æ³•è§£å†³ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼š

1. **ä½ çš„æ“ä½œç³»ç»Ÿ**: Windows 10/11ï¼Ÿ
2. **æ˜¯å¦æœ‰Android Studio**: å·²å®‰è£…/æœªå®‰è£…
3. **Javaç‰ˆæœ¬**: è¿è¡Œ `java -version` çš„è¾“å‡º
4. **é”™è¯¯ä¿¡æ¯**: å…·ä½“çš„é”™è¯¯æç¤ºæ˜¯ä»€ä¹ˆ
5. **ä½ çš„ç›®æ ‡**: æ˜¯æƒ³è‡ªå·±å­¦ä¹ å¼€å‘ï¼Œè¿˜æ˜¯åªæƒ³ä½¿ç”¨APK

æˆ‘ä¼šæ ¹æ®ä½ çš„å…·ä½“æƒ…å†µæä¾›æœ€åˆé€‚çš„è§£å†³æ–¹æ¡ˆï¼

---

## âœ… å¿«é€Ÿæ£€æŸ¥æ¸…å•

åœ¨å°è¯•æ„å»ºå‰ï¼Œç¡®è®¤ï¼š
- [ ] å®‰è£…äº†Java JDK 17
- [ ] è®¾ç½®äº†JAVA_HOMEç¯å¢ƒå˜é‡
- [ ] å®‰è£…äº†Android Studioï¼ˆæœ€ç®€å•çš„æ–¹å¼ï¼‰
- [ ] æˆ–å®‰è£…äº†ç‹¬ç«‹çš„Android SDK
- [ ] é¡¹ç›®è·¯å¾„æ²¡æœ‰ä¸­æ–‡æˆ–ç‰¹æ®Šå­—ç¬¦
- [ ] æœ‰ç¨³å®šçš„ç½‘ç»œè¿æ¥ï¼ˆä¸‹è½½ä¾èµ–ï¼‰

å¦‚æœä»¥ä¸Šä»»ä½•ä¸€é¡¹ä¸æ»¡è¶³ï¼Œå»ºè®®å…ˆç”¨**æ–¹æ¡ˆ3 (GitHub Actions)**ï¼Œå®Œå…¨ä¸éœ€è¦æœ¬åœ°ç¯å¢ƒï¼
